<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content=" Bryan Johns " />


<title>2019 Exploratory Data Analysis</title>

<script src="scratch_pad_2019_files/header-attrs-2.29/header-attrs.js"></script>
<script src="scratch_pad_2019_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="scratch_pad_2019_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="scratch_pad_2019_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="scratch_pad_2019_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="scratch_pad_2019_files/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="scratch_pad_2019_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="scratch_pad_2019_files/navigation-1.1/tabsets.js"></script>
<link href="scratch_pad_2019_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/highlightjs-9.12.0/highlight.js"></script>
<link href="scratch_pad_2019_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="scratch_pad_2019_files/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/leaflet-1.3.1/leaflet.js"></script>
<link href="scratch_pad_2019_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/proj4-2.6.2/proj4.min.js"></script>
<script src="scratch_pad_2019_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="scratch_pad_2019_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/leaflet-binding-2.2.2/leaflet.js"></script>
<link href="scratch_pad_2019_files/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="scratch_pad_2019_files/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="scratch_pad_2019_files/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="scratch_pad_2019_files/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="scratch_pad_2019_files/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
/>

<link rel="icon" type="image/x-icon" href="./resources/images/favicon.ico">


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="resources/css/styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<!-- header image and caption -->
<img src="resources/images/Logo_AI.jpeg" alt="Cyclistic Logo" style="width:200px; display:block; margin:auto;">
<p style="font-size: 12px; color: #555; margin:auto; text-align: center;">Image generated by <a href="https://designer.microsoft.com/image-creator">Microsoft Designer (Image Creator)</a></p>
 
<!-- map resizer -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
      var mapContainers = document.querySelectorAll('.map-container .leaflet-container');
      
      function resizeMaps() {
        mapContainers.forEach(function(mapContainer) {
          if (mapContainer._leaflet_map) {
            mapContainer._leaflet_map.invalidateSize();
          }
        });
      }
    
      // resizeMaps on page load
      resizeMaps();
    
      // resizeMaps on window resize
      window.addEventListener('resize', resizeMaps);
    });
</script>

<div id="header">



<h1 class="title toc-ignore">2019 Exploratory Data Analysis</h1>
<h4 class="author"><p style="font-style: italic;"><br />
Bryan Johns<br />
</p></h4>
<h4 class="date">March 2025</h4>

</div>


<div class="floating-header">
<p>2019 Exploratory Data Analysis</p>
</div>
<div id="full-analytical-workflow-and-exploratory-outputs"
class="section level2">
<h2>Full Analytical Workflow and Exploratory Outputs</h2>
<div class="button">
<p><a href="summary_2019.html#analysis">Back to<br>Cyclistic
2019</a></p>
</div>
<p>Exploratory Data Analysis, unencumbered by the need to be
<strong>too</strong> presentable.</p>
<pre class="r"><code># load data, combine into df
q1_2019 &lt;- read.csv(&quot;./resources/data/q1_2019_cleaned.csv&quot;)
q2_2019 &lt;- read.csv(&quot;./resources/data/q2_2019_cleaned.csv&quot;)
q3_2019 &lt;- read.csv(&quot;./resources/data/q3_2019_cleaned.csv&quot;)
q4_2019 &lt;- read.csv(&quot;./resources/data/q4_2019_cleaned.csv&quot;)
stations &lt;- read.csv(&quot;./resources/data/stations.csv&quot;)

df &lt;- bind_rows(q1_2019, q2_2019, q3_2019, q4_2019)</code></pre>
<p>Number of member vs casual rides</p>
<pre class="r"><code>table(df$member_casual)</code></pre>
<pre><code>## 
##  casual  member 
##  880631 2937360</code></pre>
<p>3 million member rides vs 1 million casual rides. Unfortunately,
there is no way to tell how many are repeat users. Presumably, many
member riders repeat far more often than casual riders.</p>
<p>In the scenario, and in real life, the data is shared without any
sort of identifying information that would help track that, probably why
after 2019 they removed gender and birthyear.</p>
<hr />
<p>!!NOTE!! - Below is where I realized that ride_length was in minutes
for 2019, seconds for 2020, and had to adjust data cleaning. It has been
rectified.</p>
<pre class="r"><code>summary(df$ride_length)</code></pre>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##      1.02      6.85     11.82     24.17     21.40 177200.37</code></pre>
<p>There are some ridiculously long rides.</p>
<pre class="r"><code>max(df$ride_length) / 60 / 24</code></pre>
<pre><code>## [1] 123.0558</code></pre>
<p>123 days! Hell of an outlier.</p>
<pre class="r"><code>print(df[which.max(df$ride_length), ])</code></pre>
<pre><code>##             X  ride_id          started_at            ended_at rideable_type
## 148898 148898 21920842 2019-02-14 14:44:13 2019-06-17 16:04:35          3846
##        start_station_id     start_station_name end_station_id
## 148898              213 Leavitt St &amp; North Ave            360
##                   end_station_name member_casual gender birthyear       date
## 148898 DIVVY Map Frame B/C Station        casual   &lt;NA&gt;        NA 2019-02-14
##        month day year day_of_week season hour ride_length start_lat start_lng
## 148898     2  14 2019    Thursday Winter   14    177200.4   41.9102  -87.6823
##        end_lat end_lng
## 148898      NA      NA</code></pre>
<pre class="r"><code># ggplot(df, aes(y = ride_length)) +
#   geom_boxplot() +
#   labs(title = &quot;Boxplot of Ride Lengths&quot;,
#        y = &quot;Ride Length (minutes)&quot;,
#        x = &quot;&quot;) +
#   theme_minimal()</code></pre>
<p>Kinda pointless to plot that.</p>
</div>
<div id="rides-by-member-type-total-rides-duration"
class="section level1">
<h1>Rides by Member type (total rides, duration)</h1>
<p><span style="font-size: 10pt;"><a
href="#"><svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg>
  Back to Top</a></span></p>
<pre class="r"><code># sum total ride length by membership type
total_minutes_ridden &lt;- df %&gt;%
  group_by(member_casual) %&gt;%
  summarise(total_minutes = sum(ride_length, na.rm = TRUE))

# bar chart of total minutes ridden
ggplot(total_minutes_ridden, aes(x = member_casual, y = total_minutes, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;) +
  geom_text(aes(label = round(total_minutes)), vjust = -0.5) +
  theme_minimal() +
  labs(title = &quot;Total Minutes Ridden by Membership Type&quot;, y = &quot;Total Minutes Ridden&quot;, x = &quot;Rider Type&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># sum average ride length by membership type
average_ride_length &lt;- df %&gt;%
  group_by(member_casual) %&gt;%
  summarise(average_minutes = mean(ride_length, na.rm = TRUE))

# bar chart of average ride length
ggplot(average_ride_length, aes(x = member_casual, y = average_minutes, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;) +
  geom_text(aes(label = round(average_minutes, 1)), vjust = -0.5) +
  theme_minimal() +
  labs(title = &quot;Average Ride Length by Membership Type&quot;, y = &quot;Average Ride Length (minutes)&quot;, x = &quot;Rider Type&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># bar chart 0f ride frequency per user
ggplot(df, aes(x = member_casual, fill = member_casual)) +
  geom_bar() +
  geom_text(stat = &quot;count&quot;, aes(label = ..count..), vjust = -0.5) +
  labs(
    title = &quot;Total Rides by Membership Type&quot;,
    x = &quot;Rider Type&quot;,
    y = &quot;Total Rides&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(count)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># histograms of ride length per user type
ggplot(df, aes(x = ride_length, fill = member_casual)) +
  geom_histogram(binwidth = 5, alpha = 0.7) +
  facet_wrap(~member_casual, scales = &quot;free_y&quot;) +
  labs(
    title = &quot;Histogram of Ride Lengths by Membership Type&quot;,
    x = &quot;Ride Length (minutes)&quot;,
    y = &quot;Frequency&quot;
  ) +
  theme_minimal() +
  # scale_fill_manual(values = c(&quot;member&quot; = &quot;blue&quot;, &quot;casual&quot; = &quot;red&quot;)) +
  xlim(0, 100)</code></pre>
<pre><code>## Warning: Removed 63468 rows containing non-finite outside the scale range
## (`stat_bin()`).</code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range
## (`geom_bar()`).</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Members ride more frequently for shorter duration (probably
commuting).</p>
<p>Casuals ride longer, enough to beat members for total minutes on a
bicycle.</p>
</div>
<div id="time-and-ridership" class="section level1">
<h1>Time and Ridership</h1>
<p><span style="font-size: 10pt;"><a
href="#"><svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg>
  Back to Top</a></span></p>
<pre class="r"><code># line chart of rides per month
df %&gt;%
  group_by(month, member_casual) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = month, y = rides, color = member_casual, group = member_casual)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = &quot;Rides per Month, by Customer Type&quot;, x = &quot;Month&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Peak in August, unsurprisingly.</p>
<pre class="r"><code># bar chart of rides per month
df %&gt;%
  group_by(month, member_casual) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = month, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = rides), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Total Rides per Month by Customer Type&quot;, x = &quot;Month&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code># bar chart of ride length per month
df %&gt;%
  group_by(month, member_casual) %&gt;%
  summarise(avg_ride_length = mean(ride_length, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = month, y = avg_ride_length, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = round(avg_ride_length, 1)), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Average Trip Duration per Month by Customer Type&quot;, x = &quot;Month&quot;, y = &quot;Average Trip Duration (minutes)&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>February would be an outlier - very few rides were ridden that month.
The law of small numbers. Small sample size bias.</p>
<pre class="r"><code># rides per season
df %&gt;%
  mutate(season = factor(season, levels = c(&quot;Winter&quot;, &quot;Spring&quot;, &quot;Summer&quot;, &quot;Fall&quot;))) %&gt;%
  group_by(season, member_casual) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = season, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = rides), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Total Rides per Season by Customer Type&quot;, x = &quot;Season&quot;, y = &quot;Number of Rides&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code># ride length per season
df %&gt;%
  mutate(season = factor(season, levels = c(&quot;Winter&quot;, &quot;Spring&quot;, &quot;Summer&quot;, &quot;Fall&quot;))) %&gt;%
  group_by(season, member_casual) %&gt;%
  summarise(avg_ride_length = mean(ride_length, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = season, y = avg_ride_length, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = round(avg_ride_length, 1)), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Average Trip Duration per Season by Customer Type&quot;, x = &quot;Season&quot;, y = &quot;Average Trip Duration (minutes)&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code># line chart of rides per hour
df %&gt;%
  group_by(hour, member_casual) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = hour, y = rides, color = member_casual, group = member_casual)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = &quot;Rides per Hour, by Customer Type&quot;, x = &quot;Hour&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;hour&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code># bar chart of rides per hour
df %&gt;%
  group_by(hour, member_casual) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = hour, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  theme_minimal() +
  labs(title = &quot;Rides per Hour of Day by Customer Type&quot;, x = &quot;Hour of Day&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;hour&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code># bar chart of rides per hour by day of week, free y-axis
df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  group_by(hour, member_casual, day_of_week) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = hour, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  facet_wrap(~day_of_week, scales = &quot;free_y&quot;) +
  theme_minimal() +
  labs(title = &quot;Rides per Hour of Day by Customer Type and Day of Week&quot;, subtitle = &quot;Free y-axis&quot;, x = &quot;Hour of Day&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;hour&#39;, &#39;member_casual&#39;. You can override
## using the `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># bar chart of rides per hour by day of week, locked y-axis
df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  group_by(hour, member_casual, day_of_week) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = hour, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  facet_wrap(~day_of_week) +
  theme_minimal() +
  labs(title = &quot;Rides per Hour of Day by Customer Type and Day of Week&quot;, subtitle = &quot;Locked y-axis&quot;, x = &quot;Hour of Day&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;hour&#39;, &#39;member_casual&#39;. You can override
## using the `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># bar chart of rides / member_casual / day of week
df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  group_by(member_casual, day_of_week) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = member_casual, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = rides), vjust = -0.5, position = position_dodge(0.9)) +
  facet_wrap(~day_of_week) +
  theme_minimal() +
  labs(title = &quot;Rides per Member Type by Day of Week&quot;, x = &quot;Member Type&quot;, y = &quot;Number of Rides&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;member_casual&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code># bar chart of rides / member_casual / day of week
df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  group_by(member_casual, day_of_week) %&gt;%
  summarise(rides = n()) %&gt;%
  ggplot(aes(x = day_of_week, y = rides, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = rides), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Rides per Member Type by Day of Week&quot;, x = &quot;Member Type&quot;, y = &quot;Number of Rides&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;member_casual&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code># bar chart avg ride time / member_casual / day of week
df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  group_by(member_casual, day_of_week) %&gt;%
  summarise(avg_ride_length = mean(ride_length, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = member_casual, y = avg_ride_length, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = round(avg_ride_length, 1)), vjust = -0.5, position = position_dodge(0.9)) +
  facet_wrap(~day_of_week) +
  theme_minimal() +
  labs(title = &quot;Average Ride Length per Member Type by Day of Week&quot;, x = &quot;Member Type&quot;, y = &quot;Average Ride Length (minutes)&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;member_casual&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code># bar chart avg ride time / member_casual / day of week
df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  group_by(member_casual, day_of_week) %&gt;%
  summarise(avg_ride_length = mean(ride_length, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = day_of_week, y = avg_ride_length, fill = member_casual)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_text(aes(label = round(avg_ride_length, 1)), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Average Ride Length per Member Type by Day of Week&quot;, x = &quot;Member Type&quot;, y = &quot;Average Ride Length (minutes)&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;member_casual&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code># aggregate member rider counts by hour and day of the week
member_peak_times &lt;- df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  filter(member_casual == &quot;member&quot;) %&gt;%
  group_by(day_of_week, hour) %&gt;%
  summarise(rides = n(), .groups = &quot;drop&quot;)

# heatmap of peak times for member riders
ggplot(member_peak_times, aes(x = hour, y = day_of_week, fill = rides)) +
  geom_tile() +
  scale_fill_viridis_c() +
  theme_minimal() +
  labs(title = &quot;Peak Usage Times for Member Riders&quot;, x = &quot;Hour of Day&quot;, y = &quot;Day of Week&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Members peak with commuter hours.</p>
<pre class="r"><code># aggregate casual rider counts by hour and day of the week
casual_peak_times &lt;- df %&gt;%
  mutate(day_of_week = factor(day_of_week, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))) %&gt;%
  filter(member_casual == &quot;casual&quot;) %&gt;%
  group_by(day_of_week, hour) %&gt;%
  summarise(rides = n(), .groups = &quot;drop&quot;)

# heatmap of peak times for casual riders
ggplot(casual_peak_times, aes(x = hour, y = day_of_week, fill = rides)) +
  geom_tile() +
  scale_fill_viridis_c() +
  theme_minimal() +
  labs(title = &quot;Peak Usage Times for Casual Riders&quot;, x = &quot;Hour of Day&quot;, y = &quot;Day of Week&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Peak time is Saturday afternoon, followed by Sunday afternoon.
Unsurprising.</p>
</div>
<div id="stations" class="section level1">
<h1>Stations</h1>
<p><span style="font-size: 10pt;"><a
href="#"><svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg>
  Back to Top</a></span></p>
<pre class="r"><code># map all stations

# convert the stations_2020 data frame to an sf object
stations_sf &lt;- stations %&gt;%
  drop_na() %&gt;%
  st_as_sf(coords = c(&quot;longitude&quot;, &quot;latitude&quot;), crs = 4326)

# plot map with all station locations
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = stations_sf, color = &quot;red&quot;, size = 2) +
  labs(
    title = &quot;Scatter Plot of all Station Locations&quot;,
    x = &quot;Longitude&quot;,
    y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code># bar chart: top start stations
df %&gt;%
  count(start_station_name, member_casual, sort = TRUE) %&gt;%
  group_by(member_casual) %&gt;%
  top_n(20, n) %&gt;%
  ggplot(aes(x = reorder(start_station_name, n), y = n, fill = member_casual)) +
  geom_col() +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Top Start Stations by Rider Type&quot;, x = &quot;Station Name&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-27-1.png" width="672" />
Those two bars are weird and don’t seem right. I am guessing that if I
knew the geography of Chicago, the casual / member stations would be
more illuminating. “Milleniumn Park”, “Shedd Aquarium”, “Theater on the
Lake”, “Dusable Harbor”, and “Adler Planetarium” sound like destinations
for the occasional bike rider.</p>
<pre class="r"><code># bar chart: top end stations
df %&gt;%
  count(end_station_name, member_casual, sort = TRUE) %&gt;%
  group_by(member_casual) %&gt;%
  top_n(20, n) %&gt;%
  ggplot(aes(x = reorder(end_station_name, n), y = n, fill = member_casual)) +
  geom_col() +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Top End Stations by Rider Type&quot;, x = &quot;Station Name&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code># most popular start stations
top_stations &lt;- df %&gt;%
  count(start_station_name, member_casual, sort = TRUE) %&gt;%
  group_by(member_casual) %&gt;%
  top_n(20, n)

print(top_stations)</code></pre>
<pre><code>## # A tibble: 40 × 3
## # Groups:   member_casual [2]
##    start_station_name           member_casual     n
##    &lt;chr&gt;                        &lt;chr&gt;         &lt;int&gt;
##  1 Streeter Dr &amp; Grand Ave      casual        53104
##  2 Canal St &amp; Adams St          member        50575
##  3 Clinton St &amp; Madison St      member        45990
##  4 Clinton St &amp; Washington Blvd member        45378
##  5 Lake Shore Dr &amp; Monroe St    casual        39238
##  6 Columbus Dr &amp; Randolph St    member        31370
##  7 Franklin St &amp; Monroe St      member        30832
##  8 Kingsbury St &amp; Kinzie St     member        30654
##  9 Daley Center Plaza           member        30423
## 10 Canal St &amp; Madison St        member        27138
## # ℹ 30 more rows</code></pre>
<pre class="r"><code># most popular end stations
top_stations &lt;- df %&gt;%
  count(end_station_name, member_casual, sort = TRUE) %&gt;%
  group_by(member_casual) %&gt;%
  top_n(20, n)

print(top_stations)</code></pre>
<pre><code>## # A tibble: 40 × 3
## # Groups:   member_casual [2]
##    end_station_name             member_casual     n
##    &lt;chr&gt;                        &lt;chr&gt;         &lt;int&gt;
##  1 Streeter Dr &amp; Grand Ave      casual        67585
##  2 Clinton St &amp; Washington Blvd member        48193
##  3 Canal St &amp; Adams St          member        47330
##  4 Clinton St &amp; Madison St      member        44307
##  5 Lake Shore Dr &amp; Monroe St    casual        30673
##  6 Daley Center Plaza           member        30631
##  7 Kingsbury St &amp; Kinzie St     member        30212
##  8 Michigan Ave &amp; Washington St member        27934
##  9 Franklin St &amp; Monroe St      member        26763
## 10 Canal St &amp; Madison St        member        26339
## # ℹ 30 more rows</code></pre>
<p><br />
</p>
<div class="map-container">
<pre class="r"><code># Leaflet: popular start stations with cleaned data
library(leaflet)

# remove rows with missing latitude or longitude values
cleaned_data &lt;- df %&gt;%
  filter(!is.na(start_lng) &amp; !is.na(start_lat))

# get a sample - too many rows, it crashes my computer to plot all 4 million
set.seed(123) # for reproducibility of sample
cleaned_data &lt;- cleaned_data %&gt;% sample_n(1000)

# plot sampled stations
leaflet(data = cleaned_data) %&gt;%
  addTiles() %&gt;%
  addMarkers(lng = ~start_lng, lat = ~start_lat, clusterOptions = markerClusterOptions())</code></pre>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ab41a4124c665d3784c6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ab41a4124c665d3784c6">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[41.9652,41.8793,41.8821,41.9402,41.8822,41.9183,41.9365,41.881,41.912,41.8866,41.894,41.8926,41.8958,41.9691,41.9094,41.8958,41.8842,41.9394,41.8024,41.9473,41.9114,41.8908,41.8915,41.8967,41.8977,41.8779,41.8834,41.8794,41.8772,41.8777,41.8708,41.884,41.858,41.9295,41.8026,41.8847,41.884,41.9105,41.9326,41.8726,41.8726,41.9633,41.8672,41.9313,41.894,41.9105,41.8779,41.9437,41.9184,41.8822,41.9121,41.8831,41.8958,41.8726,41.8641,41.9117,41.8822,41.908,41.8902,41.8915,41.8783,41.899,41.9319,41.9313,41.8822,41.9117,41.8772,41.8831,41.8904,41.9324,41.8576,41.8923,41.8837,41.8804,41.8841,41.8926,41.9544,41.9324,41.9408,41.8679,41.8793,41.8887,41.881,41.9097,41.9491,41.884,41.8782,41.8958,41.8772,41.899,41.8763,41.8741,41.884,41.9031,41.881,41.7851,41.9067,41.9184,41.8908,41.9455,41.7851,41.8956,41.9035,41.884,41.8958,41.8915,41.886,41.8794,41.9177,41.9671,41.8957,41.9117,41.964,41.8856,41.884,41.9147,41.8996,41.881,41.8969,41.8347,41.9291,41.9002,41.881,41.7915,41.8968,41.8834,41.8472,41.9295,41.8679,41.8855,41.887,41.9313,41.9263,41.9117,41.8777,41.8958,41.8741,41.8892,41.9652,41.9579,41.9295,41.7851,41.9494,41.9105,41.9455,41.8538,41.8842,41.9295,41.8834,41.9105,41.9408,41.9313,41.9542,41.9326,41.8986,41.8892,41.969,41.8834,41.9263,41.8856,41.8895,41.9455,41.8978,41.8899,41.8834,41.8779,41.8964,41.9139,41.894,41.8759,41.9671,41.901,41.8949,41.8388,41.8887,41.894,41.899,41.8386,41.886,41.9326,41.9289,41.9616,41.8945,41.8604,41.8831,41.8892,41.9117,41.8837,41.8906,41.9401,41.8945,41.9288,41.964,41.9267,41.9617,41.9615,41.8813,41.9633,42.0091,41.8827,42.0582,41.9617,41.956,41.9227,41.8777,41.984,41.8946,41.8713,41.8813,41.8803,41.9157,41.903,41.9291,41.9288,41.8855,41.9256,42.0326,41.881,41.9434,41.8915,41.7887,41.9542,41.8582,41.8563,41.8834,41.7943,41.8923,41.8804,41.8955,41.9094,41.9295,41.8837,41.9363,41.7915,41.9394,41.8821,41.9434,41.916,41.8956,41.9117,41.9401,41.8679,41.8772,41.8899,41.8834,41.887,41.9482,41.8923,41.9183,41.8653,41.9306,41.8822,41.9126,41.8722,41.9097,41.8887,41.9508,41.8841,41.961,41.964,41.8726,41.89,41.8822,41.9324,41.8672,41.8947,41.8421,41.8847,41.8783,41.9117,41.9263,41.8904,41.8661,41.8916,41.8915,41.8777,41.9067,41.8307,41.8793,41.884,41.9157,41.9263,41.7952,41.8996,41.8892,41.8892,41.8986,41.881,41.7996,41.8672,41.8926,41.8887,41.8859,41.9023,41.8777,41.887,41.9263,41.8947,41.8868,41.8803,41.9291,41.8672,41.8899,41.8089,41.7851,41.9733,41.8923,41.9105,41.899,41.8649,41.8859,41.9117,41.8895,41.8923,42.0127,41.9157,41.8661,41.9665,41.9434,41.8819,41.8563,41.8892,41.8837,41.8653,41.8947,41.8672,41.8776,41.8804,41.891,41.903,41.9114,41.9183,41.8842,41.9455,41.8926,42.0195,41.8957,41.8978,41.9201,41.8955,41.8918,41.7996,42.0091,41.8763,41.8309,41.8794,41.9295,41.9296,41.8847,41.8904,41.881,41.9799,41.8661,41.9408,41.8094,41.8794,41.8984,41.9288,41.887,41.8892,41.8831,41.884,41.899,41.8759,41.9067,41.896,41.9542,41.8947,41.916,41.9126,41.9157,41.8842,41.9691,41.8762,42.0582,41.7665,41.8868,41.9437,41.9312,41.9121,41.9121,41.8813,41.9324,41.8828,41.8576,41.9105,41.8945,41.9542,41.9408,41.9295,41.899,41.8576,41.8908,41.8944,41.8842,41.8793,41.7431,41.8759,41.8982,41.8822,41.8868,41.9482,41.8604,41.916,41.9117,41.8949,41.8944,41.881,41.8578,41.9652,41.8741,41.8777,41.8763,42.0505,41.8779,41.8793,41.9121,41.901,41.8846,41.853,41.795,41.9035,41.9397,41.8915,41.8926,41.8793,41.8842,41.916,41.8944,41.884,41.9312,41.8782,41.916,41.8906,41.9633,41.8982,41.9002,41.8923,41.9071,41.8708,41.8708,41.8793,41.7917,41.8672,41.8782,41.8956,41.9493,41.8855,41.9105,41.8624,41.9617,41.8847,41.8782,41.9691,41.9617,41.9291,41.8847,41.8821,41.9105,41.8892,41.8542,41.9259,41.8781,41.9402,41.9032,41.9259,41.903,41.7943,41.8347,41.8831,41.9665,41.9312,41.8679,41.9377,41.8661,41.9098,41.9023,41.8772,41.9295,41.8969,41.9288,41.896,41.9691,41.9157,41.9007,41.9585,41.9616,41.8349,41.9033,41.8313,41.9253,42.0091,41.8899,41.9032,41.8378,41.8967,41.8964,41.9182,41.8783,41.884,41.8563,41.8887,41.8777,41.8984,41.9716,41.9445,41.8781,41.8841,41.7887,41.8803,41.8777,41.8813,41.8535,41.9488,41.9288,41.9437,41.9733,41.8869,41.9104,41.8672,41.9263,41.9295,41.9182,41.8514,41.9183,41.9691,41.9306,41.8741,41.9359,41.8882,41.9029,41.8834,41.886,41.8892,41.8847,41.984,41.7952,41.9652,41.894,42.0209,41.884,41.8964,41.9117,41.8842,41.9146,41.9142,42.001,41.9033,41.9365,41.9757,41.8957,41.9183,41.8882,41.8834,41.881,42.001,41.8831,41.916,41.8672,41.8978,41.8957,41.8978,41.9291,41.9542,41.9263,41.8982,41.8804,41.8947,41.8855,41.8899,41.916,41.8847,41.8904,41.887,41.8313,41.8967,41.9182,41.8842,41.9733,41.8813,41.961,41.8923,41.8858,41.8887,41.8847,41.9105,41.9259,41.9106,41.9105,41.9401,41.9105,41.9401,41.9295,41.9002,41.9117,41.8831,41.873,41.8804,41.9437,41.9536,41.8793,41.8093,41.9218,41.8956,41.9139,41.896,41.8969,41.9482,41.9239,41.9365,41.956,41.9326,41.8822,41.7917,41.8576,41.9106,41.9157,41.9155,41.9408,41.8765,42.0121,41.8847,41.8672,41.9493,41.8804,41.9491,41.7996,41.9117,41.964,41.9117,41.8813,41.8892,41.9259,41.9695,41.9157,41.89,41.9288,41.8842,41.8827,41.8923,41.8842,41.8947,41.8652,41.884,41.8912,41.9103,41.901,41.8793,41.8847,41.8926,41.9445,41.9263,41.8763,41.8969,41.8526,41.8679,41.7915,41.8923,41.8978,41.9104,41.9395,41.8713,41.8892,41.881,41.7943,41.8947,41.8671,41.8912,41.8604,41.9263,41.8842,41.9494,41.8772,41.8819,41.9222,41.8542,41.886,42.0091,41.9106,41.8892,41.8899,41.8576,41.8969,41.9326,41.9322,41.9437,41.9408,41.8271,41.894,41.8859,41.8794,41.8855,41.8822,41.8834,41.899,41.9324,41.8906,41.7953,41.8741,41.9202,41.886,41.901,41.8957,41.8793,41.8804,41.8777,41.8847,41.9121,42.0582,41.901,41.9691,41.9377,41.886,41.9291,41.9105,41.8819,41.9046,41.8904,41.894,41.896,41.8847,41.8999,41.9691,41.9433,41.8604,41.9482,41.9528,41.8388,41.9579,41.9004,41.8978,41.9105,41.9542,41.9114,41.8904,41.8834,41.8386,41.9184,41.7915,41.8834,41.903,41.9322,41.881,42.0045,41.881,41.8803,41.8827,41.8781,41.8887,41.8944,41.8892,41.9182,41.9402,41.8777,41.8945,41.9544,41.9256,41.8847,41.8847,41.9491,41.8834,41.8908,41.9671,41.8978,41.8837,41.908,41.8781,41.8912,41.8803,41.8947,41.8759,41.8822,41.887,41.8672,41.7879,41.899,41.8772,41.8892,41.9069,41.916,41.9126,41.8856,41.8526,41.8386,41.7915,41.9183,41.9528,41.903,41.901,41.9738,41.9222,41.9534,41.8777,41.8847,41.9671,41.9218,41.8765,41.8819,41.9263,41.8759,41.8978,41.8579,41.9394,41.8821,41.8834,41.9032,41.7952,41.8822,41.9401,41.8679,41.9365,41.8916,41.8794,41.8923,41.9534,41.886,41.9665,41.8915,41.8916,41.901,41.8923,41.8803,41.8831,41.9493,41.9542,41.8779,41.9202,41.903,41.9437,41.8856,41.8708,41.8782,41.9296,41.903,41.8834,41.9126,41.8822,41.8834,41.8777,41.8902,41.8923,41.9215,41.8923,41.9322,41.8672,41.9126,41.8847,41.9218,41.9067,41.8421,41.8947,41.9288,41.8765,41.8923,41.901,41.8672,41.9199,41.9395,41.8842,41.881,41.9121,41.875,41.8904,41.9215,41.8563,41.9633,41.886,41.9263,41.886,41.9289,41.8803,41.8794,41.9171,41.881,41.881,41.9184,41.8772,41.881,41.8421,41.9291,41.8822,41.9585,41.9689,41.9544,41.9377,41.9129,41.9007,41.916,41.9023,42.0505,41.9067,41.9183,41.8977,41.9402,41.8882,41.9259,41.8672,41.8923,41.9076,41.9157,41.9437,41.8882,41.8895,41.8969,41.8947,41.8575,41.9117,41.7993,41.8795,41.9377,41.7996,41.9367,41.8782,41.9499,41.8604,41.8923,41.8831,41.894,41.9137,41.9452,41.8978,41.9069,41.9494,41.8947,41.8821,41.8978,41.9259,41.8841,41.8892,41.9313,41.8679,41.886,41.9611,41.9617,41.8821,41.9155,41.8772,41.8858,41.8974,41.9544,41.9433,41.8386,41.8892,41.8793,41.8964,41.9942,41.9035,41.8967,41.9139,41.8803,41.8837,41.9494,41.8923,41.881,41.8923,41.9437,41.9313,41.9482,41.8793,41.8781,41.9117,41.8834,41.8945,41.9508,41.9126,41.8847,41.9836,41.9319,41.9155,41.9394,41.9296,41.8923,41.9528,42.016,41.7993,41.9071,41.8708,41.8887,41.9094,41.9256,41.8661,41.9097,41.8831,41.8578,41.9296,41.8904,41.9363,41.8846,41.8977,41.8831,41.9184,41.8708,41.8579,41.884,41.896,41.9035,41.969,41.8958,41.8887,41.916],[-87.6581,-87.6399,-87.6251,-87.65300000000001,-87.64109999999999,-87.63630000000001,-87.64749999999999,-87.61669999999999,-87.6319,-87.658,-87.6293,-87.61450000000001,-87.6772,-87.6742,-87.6777,-87.6259,-87.6296,-87.66840000000001,-87.5869,-87.7176,-87.6387,-87.6317,-87.6268,-87.6357,-87.62350000000001,-87.6241,-87.6412,-87.6298,-87.62779999999999,-87.6353,-87.63120000000001,-87.6247,-87.6408,-87.6431,-87.5904,-87.6277,-87.6247,-87.65309999999999,-87.63639999999999,-87.6335,-87.6335,-87.6793,-87.626,-87.6387,-87.6293,-87.65309999999999,-87.6241,-87.649,-87.65219999999999,-87.64109999999999,-87.6347,-87.657,-87.6259,-87.6335,-87.6237,-87.6268,-87.64109999999999,-87.6315,-87.6262,-87.6268,-87.6439,-87.62990000000001,-87.67789999999999,-87.6387,-87.64109999999999,-87.6268,-87.63939999999999,-87.6373,-87.61750000000001,-87.6527,-87.6615,-87.61199999999999,-87.64870000000001,-87.6427,-87.65689999999999,-87.61450000000001,-87.648,-87.6527,-87.6392,-87.623,-87.6399,-87.6444,-87.6241,-87.6481,-87.6486,-87.6247,-87.6319,-87.6772,-87.63939999999999,-87.62990000000001,-87.6292,-87.6277,-87.6247,-87.6739,-87.61669999999999,-87.6011,-87.6348,-87.65219999999999,-87.6317,-87.6464,-87.6011,-87.6721,-87.6677,-87.6247,-87.6259,-87.6268,-87.6241,-87.6298,-87.6914,-87.679,-87.62009999999999,-87.6268,-87.6382,-87.6418,-87.6247,-87.6433,-87.6677,-87.6241,-87.6217,-87.6258,-87.6491,-87.643,-87.61669999999999,-87.59990000000001,-87.6309,-87.6412,-87.6468,-87.6431,-87.623,-87.6523,-87.61279999999999,-87.6387,-87.63079999999999,-87.6268,-87.65479999999999,-87.6259,-87.6277,-87.63849999999999,-87.6581,-87.67359999999999,-87.6431,-87.6011,-87.6545,-87.65309999999999,-87.6464,-87.6957,-87.6296,-87.6842,-87.6412,-87.65309999999999,-87.6392,-87.6387,-87.6544,-87.63639999999999,-87.6219,-87.63849999999999,-87.696,-87.6412,-87.63079999999999,-87.6418,-87.68819999999999,-87.6464,-87.6429,-87.6343,-87.6412,-87.73569999999999,-87.661,-87.64879999999999,-87.6293,-87.6408,-87.679,-87.6238,-87.6323,-87.6219,-87.6444,-87.6293,-87.62990000000001,-87.6082,-87.6309,-87.66589999999999,-87.65900000000001,-87.666,-87.61790000000001,-87.6258,-87.6373,-87.62779999999999,-87.6268,-87.64870000000001,-87.6221,-87.6455,-87.61790000000001,-87.6639,-87.6382,-87.6977,-87.6546,-87.69119999999999,-87.62949999999999,-87.6793,-87.6742,-87.63249999999999,-87.67740000000001,-87.6546,-87.6803,-87.6972,-87.6353,-87.6523,-87.6534,-87.6737,-87.62949999999999,-87.6352,-87.63460000000001,-87.6313,-87.6491,-87.6639,-87.6523,-87.6584,-87.67910000000001,-87.61669999999999,-87.67959999999999,-87.6268,-87.60129999999999,-87.6644,-87.65649999999999,-87.6133,-87.6412,-87.6015,-87.61199999999999,-87.6427,-87.682,-87.6777,-87.6431,-87.64870000000001,-87.6527,-87.59990000000001,-87.66840000000001,-87.63979999999999,-87.67959999999999,-87.66889999999999,-87.6721,-87.6268,-87.6455,-87.623,-87.62779999999999,-87.6343,-87.6412,-87.61279999999999,-87.6639,-87.61199999999999,-87.63630000000001,-87.61790000000001,-87.7238,-87.64109999999999,-87.6814,-87.6615,-87.7166,-87.6444,-87.6592,-87.65430000000001,-87.64960000000001,-87.6382,-87.6335,-87.6366,-87.64109999999999,-87.6527,-87.61539999999999,-87.6384,-87.617,-87.6277,-87.6439,-87.6268,-87.63079999999999,-87.61750000000001,-87.6073,-87.6484,-87.6268,-87.6353,-87.6348,-87.6472,-87.63200000000001,-87.6247,-87.63460000000001,-87.63079999999999,-87.58069999999999,-87.6677,-87.63849999999999,-87.63849999999999,-87.6219,-87.61669999999999,-87.5947,-87.626,-87.61450000000001,-87.6444,-87.66719999999999,-87.6277,-87.65479999999999,-87.61279999999999,-87.63079999999999,-87.6384,-87.6223,-87.6352,-87.6491,-87.61539999999999,-87.6343,-87.6645,-87.6011,-87.6678,-87.61199999999999,-87.65309999999999,-87.62990000000001,-87.64709999999999,-87.66719999999999,-87.6268,-87.68819999999999,-87.61199999999999,-87.6661,-87.63460000000001,-87.6073,-87.6884,-87.67959999999999,-87.64879999999999,-87.6133,-87.63849999999999,-87.64870000000001,-87.61790000000001,-87.6384,-87.61539999999999,-87.64960000000001,-87.6427,-87.63549999999999,-87.6313,-87.6387,-87.63630000000001,-87.6296,-87.6464,-87.61450000000001,-87.6696,-87.62009999999999,-87.6429,-87.67789999999999,-87.682,-87.6206,-87.5947,-87.6742,-87.6292,-87.628,-87.6298,-87.6431,-87.7079,-87.6195,-87.61750000000001,-87.61669999999999,-87.6819,-87.6073,-87.6392,-87.5919,-87.63549999999999,-87.6866,-87.66849999999999,-87.61279999999999,-87.62779999999999,-87.6373,-87.6247,-87.62990000000001,-87.6306,-87.6348,-87.6677,-87.6544,-87.6344,-87.6773,-87.6814,-87.63460000000001,-87.6296,-87.6742,-87.62439999999999,-87.67740000000001,-87.5865,-87.6223,-87.649,-87.6443,-87.6347,-87.6347,-87.62949999999999,-87.6527,-87.66119999999999,-87.6615,-87.65309999999999,-87.61790000000001,-87.6544,-87.6392,-87.6431,-87.62990000000001,-87.6615,-87.6317,-87.62269999999999,-87.6296,-87.6399,-87.6148,-87.6306,-87.6375,-87.64109999999999,-87.6223,-87.6639,-87.6258,-87.66889999999999,-87.6268,-87.6323,-87.62269999999999,-87.6241,-87.6246,-87.6581,-87.6277,-87.6353,-87.6292,-87.6778,-87.6241,-87.6399,-87.6347,-87.6238,-87.6319,-87.6306,-87.6331,-87.6434,-87.6589,-87.6268,-87.61450000000001,-87.6399,-87.6296,-87.66889999999999,-87.62269999999999,-87.6247,-87.6443,-87.6319,-87.66889999999999,-87.6221,-87.6793,-87.6375,-87.643,-87.61199999999999,-87.6673,-87.63120000000001,-87.63120000000001,-87.6399,-87.5839,-87.626,-87.6319,-87.6721,-87.6463,-87.6523,-87.65309999999999,-87.6511,-87.6546,-87.6195,-87.6319,-87.6742,-87.6546,-87.6491,-87.6195,-87.63979999999999,-87.6896,-87.63849999999999,-87.61920000000001,-87.639,-87.63979999999999,-87.65300000000001,-87.6343,-87.6493,-87.6313,-87.6015,-87.6258,-87.6373,-87.6884,-87.6443,-87.623,-87.64409999999999,-87.6073,-87.70529999999999,-87.6277,-87.63939999999999,-87.6431,-87.6217,-87.6639,-87.6677,-87.6742,-87.63460000000001,-87.6626,-87.655,-87.666,-87.61790000000001,-87.6784,-87.6088,-87.6658,-87.6742,-87.6343,-87.6343,-87.6511,-87.6357,-87.6541,-87.65689999999999,-87.6439,-87.6247,-87.6133,-87.6444,-87.65479999999999,-87.6866,-87.6502,-87.65470000000001,-87.63979999999999,-87.65689999999999,-87.60129999999999,-87.6352,-87.65479999999999,-87.62949999999999,-87.7051,-87.67529999999999,-87.6639,-87.649,-87.6678,-87.626,-87.6972,-87.61539999999999,-87.63079999999999,-87.6431,-87.65689999999999,-87.61879999999999,-87.63630000000001,-87.6742,-87.7238,-87.6277,-87.6784,-87.63639999999999,-87.68729999999999,-87.6412,-87.6309,-87.63849999999999,-87.6277,-87.6523,-87.58069999999999,-87.6581,-87.6293,-87.6651,-87.6247,-87.6541,-87.6268,-87.6296,-87.66800000000001,-87.71680000000001,-87.66119999999999,-87.6784,-87.64749999999999,-87.7093,-87.62009999999999,-87.63630000000001,-87.63639999999999,-87.6412,-87.61669999999999,-87.66119999999999,-87.6373,-87.6773,-87.61539999999999,-87.6429,-87.62009999999999,-87.6429,-87.6491,-87.6644,-87.63079999999999,-87.6375,-87.6427,-87.6384,-87.6523,-87.6343,-87.6773,-87.6195,-87.61750000000001,-87.61279999999999,-87.6088,-87.6357,-87.65689999999999,-87.6296,-87.6678,-87.62949999999999,-87.64960000000001,-87.61199999999999,-87.63549999999999,-87.6444,-87.6277,-87.6896,-87.639,-87.6494,-87.6896,-87.6455,-87.65309999999999,-87.6455,-87.6431,-87.643,-87.6268,-87.6373,-87.6691,-87.6427,-87.649,-87.7093,-87.63200000000001,-87.63339999999999,-87.64409999999999,-87.6721,-87.64879999999999,-87.6677,-87.6217,-87.6639,-87.6358,-87.64749999999999,-87.6803,-87.66589999999999,-87.64109999999999,-87.5839,-87.6194,-87.6494,-87.63460000000001,-87.687,-87.6392,-87.62050000000001,-87.6829,-87.6195,-87.61539999999999,-87.6463,-87.6555,-87.6486,-87.5947,-87.6268,-87.6382,-87.6268,-87.62949999999999,-87.62779999999999,-87.639,-87.65470000000001,-87.63460000000001,-87.6366,-87.6639,-87.6296,-87.63249999999999,-87.61199999999999,-87.6296,-87.6344,-87.6665,-87.6247,-87.6769,-87.67010000000001,-87.6238,-87.6399,-87.6195,-87.61450000000001,-87.65470000000001,-87.63079999999999,-87.6292,-87.6217,-87.62649999999999,-87.623,-87.59990000000001,-87.61199999999999,-87.6429,-87.6972,-87.66379999999999,-87.6737,-87.63849999999999,-87.61669999999999,-87.6015,-87.6384,-87.64109999999999,-87.6769,-87.6258,-87.63079999999999,-87.6296,-87.6545,-87.62779999999999,-87.64879999999999,-87.63890000000001,-87.61920000000001,-87.6309,-87.6742,-87.6494,-87.63849999999999,-87.6343,-87.6615,-87.6217,-87.63639999999999,-87.65860000000001,-87.649,-87.6392,-87.64570000000001,-87.6293,-87.66719999999999,-87.63549999999999,-87.6523,-87.64109999999999,-87.6412,-87.62990000000001,-87.6527,-87.6221,-87.59650000000001,-87.6277,-87.693,-87.6241,-87.6238,-87.62009999999999,-87.6399,-87.6427,-87.65479999999999,-87.6195,-87.6347,-87.67740000000001,-87.6238,-87.6742,-87.64409999999999,-87.6241,-87.6491,-87.65309999999999,-87.64879999999999,-87.64060000000001,-87.61750000000001,-87.6293,-87.6677,-87.6195,-87.6344,-87.6742,-87.67100000000001,-87.6258,-87.6639,-87.65000000000001,-87.6219,-87.6495,-87.69670000000001,-87.6429,-87.65309999999999,-87.6544,-87.6387,-87.61750000000001,-87.6412,-87.6082,-87.65219999999999,-87.59990000000001,-87.6412,-87.6313,-87.65860000000001,-87.6241,-87.6724,-87.6241,-87.6352,-87.63249999999999,-87.63979999999999,-87.6444,-87.62269999999999,-87.63849999999999,-87.65689999999999,-87.65300000000001,-87.6353,-87.61790000000001,-87.648,-87.6584,-87.6277,-87.6195,-87.6486,-87.6412,-87.6317,-87.6674,-87.6429,-87.64870000000001,-87.6315,-87.63979999999999,-87.6769,-87.6352,-87.6384,-87.6306,-87.64109999999999,-87.61279999999999,-87.626,-87.5883,-87.62990000000001,-87.63939999999999,-87.62779999999999,-87.6262,-87.66889999999999,-87.6814,-87.6418,-87.62649999999999,-87.6082,-87.59990000000001,-87.63630000000001,-87.65000000000001,-87.69750000000001,-87.6238,-87.6597,-87.63890000000001,-87.732,-87.65479999999999,-87.6195,-87.6674,-87.64409999999999,-87.62050000000001,-87.64879999999999,-87.63079999999999,-87.6306,-87.6429,-87.6687,-87.66840000000001,-87.63979999999999,-87.6412,-87.6343,-87.58069999999999,-87.64109999999999,-87.6455,-87.623,-87.64749999999999,-87.6484,-87.6298,-87.61199999999999,-87.732,-87.6309,-87.6884,-87.6268,-87.6484,-87.6238,-87.61199999999999,-87.6352,-87.6373,-87.6463,-87.6544,-87.6241,-87.693,-87.6313,-87.664,-87.6418,-87.63120000000001,-87.6319,-87.7079,-87.6313,-87.6412,-87.6814,-87.64109999999999,-87.6412,-87.65479999999999,-87.6262,-87.61199999999999,-87.6538,-87.61199999999999,-87.65860000000001,-87.626,-87.6814,-87.6277,-87.64409999999999,-87.6348,-87.617,-87.6344,-87.66849999999999,-87.62050000000001,-87.61199999999999,-87.6238,-87.626,-87.64879999999999,-87.66379999999999,-87.6296,-87.6241,-87.6347,-87.6733,-87.61750000000001,-87.6538,-87.6133,-87.6793,-87.6309,-87.63079999999999,-87.6309,-87.65900000000001,-87.6352,-87.6298,-87.7102,-87.6241,-87.6241,-87.65219999999999,-87.63939999999999,-87.61669999999999,-87.617,-87.6491,-87.64109999999999,-87.655,-87.684,-87.648,-87.64409999999999,-87.66419999999999,-87.6626,-87.66889999999999,-87.6277,-87.6778,-87.6348,-87.63630000000001,-87.62350000000001,-87.65300000000001,-87.63639999999999,-87.6493,-87.626,-87.61199999999999,-87.6386,-87.63460000000001,-87.664,-87.63639999999999,-87.68819999999999,-87.6217,-87.6384,-87.6463,-87.6268,-87.601,-87.62569999999999,-87.64409999999999,-87.5947,-87.63679999999999,-87.6319,-87.7139,-87.6258,-87.61199999999999,-87.6373,-87.6293,-87.6529,-87.7067,-87.6429,-87.6262,-87.6545,-87.6344,-87.63979999999999,-87.6429,-87.6493,-87.65689999999999,-87.62779999999999,-87.6387,-87.623,-87.6309,-87.729,-87.6546,-87.63979999999999,-87.687,-87.62779999999999,-87.63549999999999,-87.62869999999999,-87.648,-87.67100000000001,-87.6082,-87.63849999999999,-87.6399,-87.661,-87.68940000000001,-87.6677,-87.6357,-87.64879999999999,-87.6352,-87.64870000000001,-87.6545,-87.61199999999999,-87.61669999999999,-87.61199999999999,-87.649,-87.6387,-87.6639,-87.6399,-87.63979999999999,-87.6268,-87.6412,-87.61790000000001,-87.6592,-87.6814,-87.6195,-87.6692,-87.67789999999999,-87.687,-87.7236,-87.7079,-87.61199999999999,-87.65000000000001,-87.6686,-87.601,-87.6673,-87.62569999999999,-87.6444,-87.6777,-87.6584,-87.6073,-87.6481,-87.657,-87.6246,-87.7079,-87.61750000000001,-87.6527,-87.6319,-87.62350000000001,-87.6373,-87.65219999999999,-87.62569999999999,-87.6687,-87.6247,-87.6677,-87.6434,-87.696,-87.6259,-87.6444,-87.66889999999999],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,{"showCoverageOnHover":true,"zoomToBoundsOnClick":true,"spiderfyOnMaxZoom":true,"removeOutsideVisibleBounds":true,"spiderLegPolylineOptions":{"weight":1.5,"color":"#222","opacity":0.5},"freezeAtZoom":false},null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.7431,42.0582],"lng":[-87.73569999999999,-87.58069999999999]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br />
</p>
<div class="map-container">
<pre class="r"><code># Leaflet: popular end stations with cleaned data

# remove rows with missing latitude or longitude values
cleaned_data &lt;- df %&gt;%
  filter(!is.na(end_lng) &amp; !is.na(end_lat))

# get a sample - too many rows, it crashes my computer to plot all 4 million
set.seed(123) # for reproducibility of sample
cleaned_data &lt;- cleaned_data %&gt;% sample_n(1000)

# plot sampled stations
leaflet(data = cleaned_data) %&gt;%
  addTiles() %&gt;%
  addMarkers(lng = ~end_lng, lat = ~end_lat, clusterOptions = markerClusterOptions())</code></pre>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-8f6bead2653719ebac25" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-8f6bead2653719ebac25">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[41.901,41.8859,41.89,41.9181,41.8793,41.9035,41.984,41.8923,41.916,41.9493,41.8776,41.881,41.9312,41.9289,41.894,41.961,41.8969,41.8566,41.9215,41.903,41.8938,41.916,41.899,41.8856,41.8821,41.8945,41.903,41.8672,41.8804,41.8672,41.9067,41.8165,41.8793,41.9208,41.9105,41.9067,41.8246,41.9117,41.9326,41.9494,41.9208,41.8892,41.8846,41.8653,41.8882,41.9222,41.7917,41.9494,41.8386,41.8846,41.9147,41.8772,41.9756,41.9029,41.9585,41.8938,41.8968,41.8969,41.9137,41.8759,41.9493,41.8837,41.8098,41.8968,41.9069,41.8782,41.8794,41.8949,41.8899,41.9117,41.9033,41.9184,41.8834,41.9102,41.9199,41.9181,41.8661,41.894,41.8904,41.8978,41.9117,41.9367,41.8721,41.9288,41.9035,41.9117,41.9397,41.8834,41.8058,41.9437,41.9493,41.9488,41.8863,41.8923,41.8679,41.8782,41.8421,41.9184,41.8977,41.9406,41.9013,41.886,41.853,41.9508,41.8708,41.881,41.8793,41.9067,41.901,41.9031,41.9114,41.8926,41.9171,41.9208,41.9394,41.8817,41.8726,41.8967,41.9032,41.7952,41.9377,41.9365,41.9222,41.884,41.9579,42.0649,41.853,41.9246,41.9031,41.8822,41.8793,41.8781,41.8906,41.8576,41.8822,41.8984,41.8846,41.8902,41.9102,41.9658,41.9035,41.8847,41.8726,41.9268,41.8672,41.8947,41.8576,41.899,41.9023,41.901,41.978,41.8649,41.8803,41.8743,41.8822,41.869,41.8968,41.8984,41.8847,41.9013,41.9256,41.8672,41.8759,41.9117,41.9367,41.903,41.9433,41.9094,41.9452,41.8858,41.8679,41.9222,41.9367,41.9184,41.9077,41.8673,41.9288,41.9326,41.8803,41.9121,41.884,41.9033,41.9993,41.8793,41.8793,41.8576,41.9295,41.901,41.9031,41.9733,41.7915,41.8847,41.8822,41.8967,41.8892,41.8863,41.8679,41.7952,41.964,41.8307,41.903,41.9617,41.8895,41.9259,41.984,41.9445,41.8673,41.9183,41.8908,41.8703,41.908,41.8846,41.8958,41.8721,41.8904,41.9534,41.8916,41.9263,41.9253,41.8923,41.8781,41.8822,41.8964,41.8549,41.8718,41.9029,41.9239,41.8692,41.8958,41.9069,41.8542,42.0643,41.7996,41.9239,41.8831,41.9097,41.8904,41.8821,41.978,41.9313,41.8673,41.9437,41.9313,41.8968,41.8892,41.8938,41.8882,41.9494,41.8923,41.8837,41.9259,41.9363,41.9102,41.8378,41.8947,41.8902,41.9585,41.8759,41.9691,41.9324,41.8746,41.8604,41.8915,41.8912,41.9263,41.8673,41.8563,41.9067,41.8832,41.9437,41.8793,41.9267,41.8904,41.8967,41.9117,41.884,41.9689,41.956,41.9002,41.8819,41.9106,41.9312,41.8649,41.881,41.8856,41.8651,41.8834,41.8661,41.8923,41.8855,41.8831,41.9377,41.9287,41.8819,41.8679,41.9184,41.964,41.8947,41.8717,41.9295,41.7851,41.9202,41.9007,41.8819,41.9046,41.8904,41.9482,41.901,41.8978,41.881,41.8887,41.8679,41.8827,41.8822,41.886,41.8847,41.881,41.887,41.916,41.9716,41.8923,41.8672,41.9244,41.9032,41.8715,41.9561,41.8882,41.9401,41.8759,41.9023,41.8926,41.9897,41.8915,41.8869,41.9658,41.9253,41.8895,41.9691,41.8869,41.8938,41.8783,41.9397,41.8955,41.8904,41.8855,41.8892,41.9331,41.896,41.9035,41.89,41.9611,41.9268,41.901,41.8846,41.9367,41.8781,41.9542,41.8563,41.9437,41.9324,41.8803,41.8923,41.8978,41.8855,41.9287,41.8795,41.8847,41.9357,41.8974,41.8514,41.9491,41.9544,41.8964,41.8974,41.8741,41.8782,41.9408,41.8846,41.8846,41.9139,41.8772,41.8386,41.903,41.8947,41.9659,41.9437,41.8822,41.943,41.8821,41.9691,41.8915,41.9077,41.9035,41.8832,41.8837,41.9401,41.9199,41.8781,41.884,41.8781,41.9027,41.9615,41.8834,41.9013,41.9942,41.8563,41.8908,41.8722,41.8957,41.8814,41.8923,42.0127,41.8938,41.9579,41.8653,41.8899,41.9331,41.8847,41.9263,41.9295,41.9738,41.8514,41.8713,41.8309,41.9671,41.8708,41.8822,41.8902,41.9395,41.8814,41.9667,41.8978,41.8822,41.8923,41.9322,41.8776,41.8721,41.9363,41.901,41.8781,41.9263,41.8949,41.8728,41.8762,41.8926,42.0123,41.9579,41.7993,41.9455,41.9544,41.9097,41.8923,41.9462,41.9365,41.8847,41.8715,41.8672,41.884,41.9993,41.9032,41.8563,41.886,41.9117,41.9094,41.8944,41.894,41.963,41.8794,42.0193,41.9494,41.8892,41.9359,41.9256,41.9377,41.9067,41.7995,41.956,41.8772,41.881,41.9137,41.9289,42.016,41.8793,41.9013,41.886,41.8819,41.8882,41.964,41.8866,41.8783,41.9222,41.9208,41.9094,41.8892,41.8923,41.8777,41.9256,41.9363,41.8793,41.9033,41.873,41.8944,41.8308,42.008,41.8895,41.8904,41.8024,41.8866,41.8793,41.8977,41.8715,41.8856,41.9357,41.8803,41.8958,41.8926,42.008,41.8902,41.7915,41.8822,41.9437,41.914,41.8846,41.9268,41.8821,41.881,41.9046,41.8906,41.9067,41.894,41.8762,41.8947,41.899,41.894,41.8855,41.903,41.9029,41.9077,41.884,41.9117,41.9129,41.8992,41.887,41.9482,41.9199,41.8831,41.8834,41.8923,41.8718,41.9377,41.984,41.8858,41.881,41.9365,41.8794,41.9402,41.9402,41.8782,41.8813,41.8846,41.8892,41.8847,41.9263,41.8978,41.8679,41.8887,41.8863,41.8604,41.8793,41.9363,41.8926,41.8842,41.9494,41.8923,41.8695,41.9445,41.9455,41.9097,41.9377,41.89,41.8821,41.9365,41.8793,41.903,41.9542,41.9466,41.8661,41.8728,41.8944,41.8923,41.8856,41.9035,41.8728,41.8779,41.8846,41.8856,41.8695,41.8721,41.9094,41.9218,41.9397,41.9312,41.7993,41.8703,41.9361,41.7952,41.8915,41.8793,41.9218,41.8604,41.881,41.9126,41.886,41.9103,41.9522,41.8918,41.916,41.9617,41.9402,41.8834,41.9094,41.8782,41.901,41.8793,41.8713,41.9103,41.7851,41.9402,41.886,41.8908,41.901,41.8672,41.884,41.9408,41.8804,41.8926,41.8918,41.8708,41.8781,41.8672,42.0505,41.8842,41.9002,42.0482,41.9184,41.8947,41.884,41.8822,41.9377,41.8832,41.9756,41.9942,41.881,41.9071,41.887,41.8718,41.9312,41.9482,41.9208,41.8999,41.9256,41.9035,41.9035,41.8649,41.8721,41.9183,41.8923,41.8915,41.9695,41.9357,41.8793,41.8708,41.9182,41.9171,41.956,41.9437,41.8551,41.9507,41.9218,41.8776,41.9367,41.881,41.8793,41.795,41.9494,41.9402,41.8671,41.8814,41.9402,41.8604,41.9157,41.8895,41.8673,41.8847,41.9033,41.9401,41.896,41.7915,41.8309,41.8708,41.9222,41.9377,41.9002,41.8906,41.8549,42.0046,41.881,41.8944,41.969,41.8347,41.8918,41.8902,41.8912,41.9181,41.914,41.7943,41.9121,41.9117,41.9363,41.8882,41.894,41.8969,41.8977,41.8819,41.9324,41.9023,41.8837,41.8672,41.8892,41.881,41.9218,41.9067,41.9363,41.8923,41.9324,41.8947,41.9117,41.7952,41.8832,41.8777,41.8777,41.8665,41.8728,41.8386,41.8813,41.8837,41.8923,41.886,41.9437,41.9542,41.8759,41.9268,41.9488,41.8916,41.881,41.8831,41.9836,41.8837,41.9579,41.8858,41.8916,41.908,41.8923,41.7851,41.9482,41.8386,41.8944,41.8762,41.8421,41.8947,41.8892,41.8795,41.886,41.8715,41.8856,41.8416,41.9905,41.8916,41.8834,41.8813,41.9445,41.8713,41.8969,41.881,41.8759,41.8834,41.8906,41.8582,41.9295,41.9361,41.8793,41.884,41.8803,41.9324,41.9691,41.9035,41.8793,41.8672,41.887,41.9033,41.9571,41.9117,41.8057,41.8679,41.8842,41.9069,42.0127,41.8868,41.8958,41.881,42.0482,41.8713,41.8672,41.9671,41.887,41.9295,41.916,41.8834,41.8834,41.8695,41.896,41.9071,41.8842,41.9215,41.881,41.9361,41.964,41.9076,41.916,41.8641,41.8869,41.8918,41.8882,41.7915,41.894,41.9313,41.8793,41.9691,41.8672,41.9295,41.9691,41.9071,41.901,41.8958,41.8822,41.8968,41.8803,41.8717,41.9547,41.984,41.8911,41.8777,41.8641,41.8672,41.9445,41.8958,41.9295,41.8728,41.9331,41.9227,41.886,41.8947,41.8842,41.8834,41.9067,41.9287,41.9256,41.8782,41.9105,41.8821,41.9263,41.9137,41.8906,41.903,41.8923,41.8793,41.8858,41.8944,41.9184,41.9094,41.8895,41.8899,41.8969,41.9263,41.8416,41.8306,41.9331,41.8834,41.8514,41.9547,41.8899,41.9256,41.7952,41.8793,41.8765,41.9023,41.886,41.9691,41.9445,41.8855,41.9259,41.8868,41.9659,41.9494,41.8828,41.8695,41.8904,41.9208,41.9408,41.8819,41.8923,41.8578,41.8782,41.9738,41.8892,41.8908,41.8793,41.8968,41.9035,41.881,41.881,41.9097,41.9077,41.9155,41.9684,41.9032,41.8798,41.8822,41.8759,41.9363,41.8908,41.9326,41.9256,41.9357,41.8916,41.875,41.8899,41.903,41.8793,41.9263,41.8969,41.881,41.9493,41.9488,41.9401,41.8762,41.9076,41.8947,41.9256,41.8763,41.8748,41.8672,41.8672,41.8576,41.8772,41.961,41.7995,41.8822,41.8803,41.9031,41.9377,41.8813,41.886,41.8795,41.8675,41.8916,41.9259,41.8916,41.8613,41.8904,41.8673,41.903,41.8947,41.8947,41.884,41.9259,41.9733,41.8722,41.8578,41.9031,41.9784,41.8847,41.912,41.9614,41.9397,41.8772,41.8863,41.978,41.9035,41.9295,41.7851,41.9227,41.908,41.8708,41.7943,41.8926,41.8436,41.9256,41.9218,41.8868],[-87.6238,-87.66719999999999,-87.6366,-87.6437,-87.6399,-87.6434,-87.66030000000001,-87.61199999999999,-87.6773,-87.6463,-87.64960000000001,-87.61669999999999,-87.6443,-87.65900000000001,-87.6293,-87.64960000000001,-87.6217,-87.6275,-87.6538,-87.6313,-87.6417,-87.66889999999999,-87.62990000000001,-87.6418,-87.63979999999999,-87.61790000000001,-87.6313,-87.626,-87.6427,-87.61539999999999,-87.6348,-87.6066,-87.6399,-87.66370000000001,-87.65309999999999,-87.6348,-87.6168,-87.6268,-87.63639999999999,-87.6545,-87.66370000000001,-87.63849999999999,-87.6319,-87.61790000000001,-87.63639999999999,-87.63890000000001,-87.5839,-87.6545,-87.6082,-87.6319,-87.6433,-87.63939999999999,-87.6795,-87.68729999999999,-87.655,-87.6417,-87.6309,-87.6217,-87.6529,-87.6306,-87.6463,-87.64870000000001,-87.5994,-87.6309,-87.6262,-87.6319,-87.6298,-87.6323,-87.6343,-87.6268,-87.6784,-87.65219999999999,-87.6412,-87.6823,-87.64879999999999,-87.6437,-87.6073,-87.6293,-87.61750000000001,-87.6429,-87.6268,-87.63679999999999,-87.62949999999999,-87.6639,-87.6677,-87.6268,-87.6589,-87.6412,-87.5925,-87.664,-87.6463,-87.67529999999999,-87.61750000000001,-87.61199999999999,-87.623,-87.6319,-87.617,-87.65219999999999,-87.62350000000001,-87.6785,-87.67740000000001,-87.6241,-87.6306,-87.6592,-87.62569999999999,-87.6241,-87.63200000000001,-87.6348,-87.6238,-87.6739,-87.6387,-87.61450000000001,-87.7102,-87.66370000000001,-87.6833,-87.6395,-87.6335,-87.6357,-87.6343,-87.58069999999999,-87.64409999999999,-87.64749999999999,-87.63890000000001,-87.6247,-87.6495,-87.7153,-87.6306,-87.6893,-87.6739,-87.64109999999999,-87.6399,-87.63979999999999,-87.6221,-87.6615,-87.64109999999999,-87.6866,-87.6319,-87.6262,-87.6435,-87.6454,-87.6677,-87.6277,-87.6335,-87.6344,-87.61539999999999,-87.6344,-87.6615,-87.62990000000001,-87.6277,-87.6238,-87.66800000000001,-87.64709999999999,-87.6352,-87.6396,-87.64109999999999,-87.6591,-87.6309,-87.6866,-87.6277,-87.67740000000001,-87.6537,-87.61539999999999,-87.6408,-87.6268,-87.63679999999999,-87.6313,-87.67100000000001,-87.6777,-87.7067,-87.63549999999999,-87.623,-87.63890000000001,-87.63679999999999,-87.65219999999999,-87.6726,-87.6486,-87.66849999999999,-87.63639999999999,-87.6352,-87.6347,-87.6247,-87.6784,-87.67140000000001,-87.6399,-87.6399,-87.6194,-87.6431,-87.6238,-87.6739,-87.6678,-87.59990000000001,-87.6277,-87.64109999999999,-87.6357,-87.62779999999999,-87.61750000000001,-87.623,-87.58069999999999,-87.6382,-87.6472,-87.6313,-87.6546,-87.68819999999999,-87.639,-87.6523,-87.65470000000001,-87.6486,-87.63630000000001,-87.6317,-87.6395,-87.6315,-87.6446,-87.6259,-87.62949999999999,-87.61750000000001,-87.732,-87.6484,-87.63079999999999,-87.6658,-87.61199999999999,-87.63979999999999,-87.64109999999999,-87.6541,-87.6636,-87.64660000000001,-87.68729999999999,-87.6358,-87.67100000000001,-87.6772,-87.6262,-87.61920000000001,-87.6862,-87.5947,-87.6358,-87.6373,-87.7166,-87.61750000000001,-87.63979999999999,-87.66800000000001,-87.6387,-87.6486,-87.649,-87.6387,-87.6309,-87.62779999999999,-87.6417,-87.63639999999999,-87.6545,-87.61199999999999,-87.64870000000001,-87.6493,-87.6527,-87.6823,-87.6511,-87.6344,-87.6262,-87.655,-87.6306,-87.6742,-87.6527,-87.657,-87.6258,-87.6268,-87.6769,-87.63079999999999,-87.6486,-87.6133,-87.6348,-87.6511,-87.664,-87.6399,-87.6977,-87.61750000000001,-87.6357,-87.6268,-87.6247,-87.684,-87.6803,-87.643,-87.64879999999999,-87.6494,-87.6443,-87.64709999999999,-87.6241,-87.6418,-87.657,-87.6412,-87.6073,-87.61199999999999,-87.6523,-87.657,-87.64409999999999,-87.6538,-87.64879999999999,-87.623,-87.65219999999999,-87.6382,-87.6344,-87.651,-87.6431,-87.6011,-87.693,-87.6626,-87.64879999999999,-87.64060000000001,-87.61750000000001,-87.6639,-87.6238,-87.6429,-87.6241,-87.6444,-87.623,-87.63249999999999,-87.64109999999999,-87.6309,-87.6195,-87.6241,-87.61279999999999,-87.66889999999999,-87.6502,-87.61199999999999,-87.61539999999999,-87.7154,-87.6343,-87.6699,-87.6688,-87.63639999999999,-87.6455,-87.6306,-87.6277,-87.61450000000001,-87.6601,-87.6268,-87.626,-87.6454,-87.6658,-87.68819999999999,-87.6742,-87.626,-87.6417,-87.6439,-87.6589,-87.682,-87.61750000000001,-87.6523,-87.63849999999999,-87.6478,-87.6677,-87.6677,-87.6366,-87.73569999999999,-87.6344,-87.6238,-87.6319,-87.63679999999999,-87.63979999999999,-87.6544,-87.6133,-87.649,-87.6527,-87.6352,-87.61199999999999,-87.6429,-87.6523,-87.6538,-87.62569999999999,-87.6195,-87.6636,-87.62869999999999,-87.61879999999999,-87.6486,-87.648,-87.661,-87.62869999999999,-87.6277,-87.6319,-87.6392,-87.6446,-87.6446,-87.64879999999999,-87.63939999999999,-87.6082,-87.6313,-87.6384,-87.6936,-87.664,-87.64109999999999,-87.68729999999999,-87.6251,-87.6742,-87.6268,-87.6726,-87.6677,-87.6511,-87.64870000000001,-87.6455,-87.64879999999999,-87.63979999999999,-87.6247,-87.63979999999999,-87.7092,-87.67140000000001,-87.6412,-87.67740000000001,-87.68940000000001,-87.6133,-87.6317,-87.6615,-87.62009999999999,-87.67489999999999,-87.61199999999999,-87.6661,-87.6417,-87.6495,-87.61790000000001,-87.6343,-87.6478,-87.6195,-87.63079999999999,-87.6431,-87.6597,-87.61879999999999,-87.6737,-87.628,-87.6674,-87.62569999999999,-87.64109999999999,-87.6262,-87.66379999999999,-87.67489999999999,-87.7081,-87.6429,-87.64109999999999,-87.61199999999999,-87.65860000000001,-87.64960000000001,-87.62949999999999,-87.6527,-87.6238,-87.63979999999999,-87.63079999999999,-87.6323,-87.624,-87.62439999999999,-87.61450000000001,-87.68819999999999,-87.67359999999999,-87.601,-87.6464,-87.648,-87.6481,-87.61199999999999,-87.6733,-87.64749999999999,-87.6195,-87.6409,-87.61539999999999,-87.6247,-87.67140000000001,-87.6343,-87.6133,-87.6241,-87.6268,-87.6777,-87.62269999999999,-87.6293,-87.6848,-87.6298,-87.6845,-87.6545,-87.62779999999999,-87.6784,-87.6537,-87.64409999999999,-87.6348,-87.5865,-87.6803,-87.62779999999999,-87.61669999999999,-87.6529,-87.65900000000001,-87.6686,-87.6399,-87.67740000000001,-87.6241,-87.64879999999999,-87.63639999999999,-87.6382,-87.658,-87.6439,-87.63890000000001,-87.66370000000001,-87.6777,-87.62779999999999,-87.61199999999999,-87.65479999999999,-87.6537,-87.6527,-87.6399,-87.6784,-87.6691,-87.62269999999999,-87.63249999999999,-87.66549999999999,-87.68819999999999,-87.61750000000001,-87.5869,-87.658,-87.63200000000001,-87.62350000000001,-87.6409,-87.6418,-87.6636,-87.6352,-87.6772,-87.61450000000001,-87.66549999999999,-87.6262,-87.59990000000001,-87.64109999999999,-87.649,-87.7051,-87.6446,-87.6344,-87.63979999999999,-87.61669999999999,-87.64060000000001,-87.6221,-87.6348,-87.6293,-87.62439999999999,-87.6344,-87.62990000000001,-87.6293,-87.6523,-87.6313,-87.68729999999999,-87.6726,-87.6247,-87.6268,-87.66419999999999,-87.6722,-87.61279999999999,-87.6639,-87.64879999999999,-87.6373,-87.6412,-87.61199999999999,-87.64660000000001,-87.64409999999999,-87.6523,-87.63549999999999,-87.6241,-87.64749999999999,-87.63549999999999,-87.65300000000001,-87.65300000000001,-87.6319,-87.62949999999999,-87.6319,-87.63849999999999,-87.6277,-87.63079999999999,-87.6429,-87.623,-87.6444,-87.61750000000001,-87.6258,-87.63200000000001,-87.6527,-87.61450000000001,-87.6296,-87.6545,-87.61199999999999,-87.6555,-87.65470000000001,-87.6464,-87.6481,-87.64409999999999,-87.6366,-87.63979999999999,-87.64749999999999,-87.6399,-87.6313,-87.6644,-87.69459999999999,-87.6073,-87.624,-87.62269999999999,-87.61199999999999,-87.6418,-87.6677,-87.624,-87.6241,-87.6319,-87.6418,-87.6555,-87.62949999999999,-87.6777,-87.64409999999999,-87.6589,-87.6443,-87.601,-87.6395,-87.6698,-87.58069999999999,-87.6268,-87.6399,-87.64409999999999,-87.6258,-87.61669999999999,-87.6814,-87.6309,-87.67010000000001,-87.6981,-87.6588,-87.6773,-87.6546,-87.65300000000001,-87.6412,-87.6777,-87.6319,-87.6238,-87.6399,-87.6737,-87.67010000000001,-87.6011,-87.65300000000001,-87.6309,-87.6317,-87.6238,-87.61539999999999,-87.6247,-87.6392,-87.6555,-87.61450000000001,-87.6206,-87.63120000000001,-87.63979999999999,-87.626,-87.6778,-87.6296,-87.643,-87.6835,-87.65219999999999,-87.6384,-87.6247,-87.64109999999999,-87.64409999999999,-87.6511,-87.6795,-87.68940000000001,-87.6241,-87.6673,-87.61279999999999,-87.64660000000001,-87.6443,-87.6639,-87.66370000000001,-87.6344,-87.6537,-87.6677,-87.6677,-87.64709999999999,-87.62949999999999,-87.63630000000001,-87.61199999999999,-87.6268,-87.65470000000001,-87.6636,-87.6399,-87.62569999999999,-87.65689999999999,-87.7102,-87.6803,-87.664,-87.6541,-87.6687,-87.64409999999999,-87.64960000000001,-87.63679999999999,-87.61669999999999,-87.6399,-87.6331,-87.6545,-87.65300000000001,-87.64109999999999,-87.67489999999999,-87.65300000000001,-87.6258,-87.63460000000001,-87.68819999999999,-87.6486,-87.6277,-87.6784,-87.6455,-87.6677,-87.59990000000001,-87.628,-87.62569999999999,-87.63890000000001,-87.64409999999999,-87.643,-87.6221,-87.6636,-87.6807,-87.6241,-87.62269999999999,-87.696,-87.6258,-87.6206,-87.6262,-87.6769,-87.6437,-87.7051,-87.6015,-87.6347,-87.6268,-87.6527,-87.63639999999999,-87.6293,-87.6217,-87.62350000000001,-87.64879999999999,-87.6527,-87.6277,-87.64870000000001,-87.626,-87.63849999999999,-87.61669999999999,-87.64409999999999,-87.6348,-87.6527,-87.61199999999999,-87.6527,-87.6384,-87.6268,-87.58069999999999,-87.6511,-87.6353,-87.65479999999999,-87.68470000000001,-87.624,-87.6082,-87.62949999999999,-87.64870000000001,-87.61199999999999,-87.6241,-87.664,-87.6544,-87.6408,-87.6344,-87.67529999999999,-87.6484,-87.6241,-87.6373,-87.6692,-87.64870000000001,-87.6495,-87.63549999999999,-87.6484,-87.6315,-87.61199999999999,-87.6011,-87.6639,-87.6082,-87.62269999999999,-87.62439999999999,-87.617,-87.6384,-87.62779999999999,-87.62569999999999,-87.67700000000001,-87.6409,-87.6418,-87.6574,-87.6698,-87.6484,-87.6412,-87.62949999999999,-87.65470000000001,-87.6737,-87.6217,-87.61669999999999,-87.6408,-87.6412,-87.6221,-87.65649999999999,-87.6431,-87.6698,-87.63200000000001,-87.6247,-87.6352,-87.6527,-87.6742,-87.6677,-87.6399,-87.61539999999999,-87.61279999999999,-87.6784,-87.66419999999999,-87.6268,-87.68340000000001,-87.623,-87.6296,-87.6262,-87.6661,-87.6223,-87.6772,-87.61669999999999,-87.6835,-87.6737,-87.61539999999999,-87.679,-87.61279999999999,-87.6431,-87.66889999999999,-87.6412,-87.6412,-87.6555,-87.6677,-87.6673,-87.6296,-87.7073,-87.6241,-87.6698,-87.6382,-87.6386,-87.66889999999999,-87.6237,-87.626,-87.6206,-87.63639999999999,-87.59990000000001,-87.6293,-87.6387,-87.63200000000001,-87.6742,-87.626,-87.6431,-87.6742,-87.6673,-87.6238,-87.6772,-87.64109999999999,-87.6309,-87.6352,-87.651,-87.6739,-87.66030000000001,-87.6666,-87.6353,-87.6237,-87.61539999999999,-87.65470000000001,-87.6772,-87.6431,-87.624,-87.6478,-87.6972,-87.6309,-87.6344,-87.6296,-87.6412,-87.6348,-87.6538,-87.6537,-87.6319,-87.65309999999999,-87.6251,-87.63079999999999,-87.6529,-87.6221,-87.6313,-87.61199999999999,-87.6399,-87.63549999999999,-87.62269999999999,-87.65219999999999,-87.6777,-87.68819999999999,-87.6343,-87.6217,-87.63079999999999,-87.6574,-87.6413,-87.6478,-87.6412,-87.61879999999999,-87.6739,-87.6343,-87.6537,-87.58069999999999,-87.6399,-87.62050000000001,-87.6277,-87.6241,-87.6742,-87.65470000000001,-87.6523,-87.639,-87.6223,-87.6936,-87.6545,-87.66119999999999,-87.6555,-87.61750000000001,-87.66370000000001,-87.6392,-87.64879999999999,-87.61199999999999,-87.6246,-87.6319,-87.6597,-87.62779999999999,-87.6317,-87.6399,-87.6309,-87.6677,-87.6241,-87.61669999999999,-87.6481,-87.6726,-87.687,-87.7118,-87.6343,-87.6861,-87.64109999999999,-87.6306,-87.6527,-87.6317,-87.63639999999999,-87.6537,-87.6636,-87.6484,-87.6331,-87.6343,-87.6313,-87.6399,-87.63079999999999,-87.6217,-87.6241,-87.6463,-87.67529999999999,-87.6455,-87.62439999999999,-87.6386,-87.6384,-87.6584,-87.6292,-87.6498,-87.626,-87.61539999999999,-87.6615,-87.62779999999999,-87.64960000000001,-87.5865,-87.64109999999999,-87.6352,-87.6739,-87.64409999999999,-87.62949999999999,-87.6241,-87.62569999999999,-87.6322,-87.6484,-87.6493,-87.6484,-87.6566,-87.61750000000001,-87.6486,-87.6313,-87.6384,-87.6344,-87.6247,-87.6493,-87.6678,-87.6615,-87.6246,-87.6739,-87.6598,-87.6195,-87.6319,-87.67619999999999,-87.6589,-87.62779999999999,-87.61750000000001,-87.66800000000001,-87.6677,-87.6431,-87.6011,-87.6972,-87.6315,-87.62569999999999,-87.6015,-87.61450000000001,-87.6454,-87.6537,-87.64409999999999,-87.6223],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,{"showCoverageOnHover":true,"zoomToBoundsOnClick":true,"spiderfyOnMaxZoom":true,"removeOutsideVisibleBounds":true,"spiderLegPolylineOptions":{"weight":1.5,"color":"#222","opacity":0.5},"freezeAtZoom":false},null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.7851,42.0649],"lng":[-87.73569999999999,-87.58069999999999]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br />
</p>
<pre class="r"><code># sample data
set.seed(123) # for reproducibility
cleaned_data &lt;- df %&gt;% sample_n(1000)

# create linestring geometries for routes
routes &lt;- cleaned_data %&gt;%
  drop_na(start_lng, start_lat, end_lng, end_lat) %&gt;%
  rowwise() %&gt;%
  mutate(geometry = st_sfc(st_linestring(matrix(c(start_lng, start_lat, end_lng, end_lat), ncol = 2, byrow = TRUE)), crs = 4326)) %&gt;%
  st_as_sf()

# plot routes
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = routes, aes(geometry = geometry), color = &quot;blue&quot;, size = 0.5, alpha = 0.5) +
  labs(
    title = &quot;Sample Routes&quot;,
    x = &quot;Longitude&quot;,
    y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Bar chart and maps of top casual stations</p>
<pre class="r"><code># aggregate casual rider counts by station
casual_peak_stations &lt;- df %&gt;%
  filter(member_casual == &quot;casual&quot;) %&gt;%
  count(start_station_name, sort = TRUE) %&gt;%
  top_n(10, n)

# bar chart of top stations for casual riders
ggplot(casual_peak_stations, aes(x = reorder(start_station_name, n), y = n, fill = start_station_name)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Top Start Stations for Casual Riders&quot;, x = &quot;Station Name&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre class="r"><code># map of top start stations for casual riders

# convert top casual start stations to sf object
casual_start_sf &lt;- casual_peak_stations %&gt;%
  left_join(df, by = c(&quot;start_station_name&quot;)) %&gt;% # Join to get lat/lng
  distinct(start_station_name, start_lat, start_lng) %&gt;% # Remove duplicates
  drop_na(start_lat, start_lng) %&gt;%
  st_as_sf(coords = c(&quot;start_lng&quot;, &quot;start_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = casual_start_sf, color = &quot;blue&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;Top Start Stations for Casual Riders (Map)&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<pre class="r"><code># extract end stations for trips originating at top casual start stations
casual_end_from_start_sf &lt;- df %&gt;%
  filter(start_station_name %in% casual_peak_stations$start_station_name) %&gt;%
  distinct(start_station_name, end_station_name, end_lat, end_lng) %&gt;%
  drop_na(end_lat, end_lng) %&gt;%
  st_as_sf(coords = c(&quot;end_lng&quot;, &quot;end_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = casual_end_from_start_sf, color = &quot;blue&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;End Stations for Trips from Top Start Stations (Casual Riders)&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<pre class="r"><code># aggregate casual rider counts by station
casual_peak_stations &lt;- df %&gt;%
  filter(member_casual == &quot;casual&quot;) %&gt;%
  count(end_station_name, sort = TRUE) %&gt;%
  top_n(10, n)

# bar chart of top stations for casual riders
ggplot(casual_peak_stations, aes(x = reorder(end_station_name, n), y = n, fill = end_station_name)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Top End Stations for Casual Riders&quot;, x = &quot;Station Name&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre class="r"><code># convert top casual end stations to sf object
casual_end_sf &lt;- casual_peak_stations %&gt;%
  left_join(df, by = c(&quot;end_station_name&quot;)) %&gt;%
  distinct(end_station_name, end_lat, end_lng) %&gt;%
  drop_na(end_lat, end_lng) %&gt;%
  st_as_sf(coords = c(&quot;end_lng&quot;, &quot;end_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = casual_end_sf, color = &quot;blue&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;Top End Stations for Casual Riders (Map)&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code># extract start stations for trips ending at top casual end stations
casual_start_from_end_sf &lt;- df %&gt;%
  filter(end_station_name %in% casual_peak_stations$end_station_name) %&gt;%
  distinct(end_station_name, start_station_name, start_lat, start_lng) %&gt;%
  drop_na(start_lat, start_lng) %&gt;%
  st_as_sf(coords = c(&quot;start_lng&quot;, &quot;start_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = casual_start_from_end_sf, color = &quot;blue&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;Start Stations for Trips Ending at Top End Stations (Casual Riders)&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Bar chart and maps of top member stations</p>
<pre class="r"><code># aggregate member rider counts by station
member_peak_stations &lt;- df %&gt;%
  filter(member_casual == &quot;member&quot;) %&gt;%
  count(start_station_name, sort = TRUE) %&gt;%
  top_n(10, n)

# bar chart of top stations for member riders
ggplot(member_peak_stations, aes(x = reorder(start_station_name, n), y = n, fill = start_station_name)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Top Start Stations for Member Riders&quot;, x = &quot;Station Name&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<pre class="r"><code># convert top member start stations to sf object
member_start_sf &lt;- member_peak_stations %&gt;%
  left_join(df, by = c(&quot;start_station_name&quot;)) %&gt;%
  distinct(start_station_name, start_lat, start_lng) %&gt;%
  drop_na(start_lat, start_lng) %&gt;%
  st_as_sf(coords = c(&quot;start_lng&quot;, &quot;start_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = member_start_sf, color = &quot;red&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;Top Start Stations for Member Riders (Map)&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<pre class="r"><code># extract end stations for trips starting at top member start stations
member_end_sf &lt;- df %&gt;%
  filter(start_station_name %in% member_peak_stations$start_station_name) %&gt;%
  distinct(start_station_name, end_station_name, end_lat, end_lng) %&gt;%
  drop_na(end_lat, end_lng) %&gt;%
  st_as_sf(coords = c(&quot;end_lng&quot;, &quot;end_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = member_end_sf, color = &quot;blue&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;End Stations for Trips from Top Start Stations&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<pre class="r"><code># aggregate member rider counts by station
member_peak_stations &lt;- df %&gt;%
  filter(member_casual == &quot;member&quot;) %&gt;%
  count(end_station_name, sort = TRUE) %&gt;%
  top_n(10, n)

# bar chart of top stations for member riders
ggplot(member_peak_stations, aes(x = reorder(end_station_name, n), y = n, fill = end_station_name)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Top End Stations for Member Riders&quot;, x = &quot;Station Name&quot;, y = &quot;Number of Rides&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<pre class="r"><code># convert top member end stations to sf object
member_end_sf &lt;- member_peak_stations %&gt;%
  left_join(df, by = c(&quot;end_station_name&quot;)) %&gt;%
  distinct(end_station_name, end_lat, end_lng) %&gt;%
  drop_na(end_lat, end_lng) %&gt;%
  st_as_sf(coords = c(&quot;end_lng&quot;, &quot;end_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = member_end_sf, color = &quot;red&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;Top End Stations for Member Riders (Map)&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<pre class="r"><code># extract start stations for trips ending at top member end stations
member_start_sf &lt;- df %&gt;%
  filter(end_station_name %in% member_peak_stations$end_station_name) %&gt;%
  distinct(end_station_name, start_station_name, start_lat, start_lng) %&gt;%
  drop_na(start_lat, start_lng) %&gt;%
  st_as_sf(coords = c(&quot;start_lng&quot;, &quot;start_lat&quot;), crs = 4326)

# plot map
ggplot() +
  annotation_map_tile(type = &quot;osm&quot;, zoom = 12) +
  geom_sf(data = member_start_sf, color = &quot;blue&quot;, size = 3, alpha = 0.7) +
  labs(
    title = &quot;Start Stations for Trips Ending at Top End Stations&quot;,
    x = &quot;Longitude&quot;, y = &quot;Latitude&quot;
  ) +
  theme_minimal()</code></pre>
<pre><code>## Zoom: 12</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
<div id="demographics" class="section level1">
<h1>Demographics</h1>
<p><span style="font-size: 10pt;"><a
href="#"><svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg>
  Back to Top</a></span></p>
<p>Remember, this is member rides and casual rides, so member’s
presumably will be over respresented.</p>
<pre class="r"><code># age distribution
ggplot(df, aes(x = 2020 - birthyear, fill = member_casual)) +
  geom_histogram(binwidth = 5, alpha = 0.7, position = &quot;dodge&quot;) +
  # stat_bin(binwidth = 5, geom = &quot;text&quot;, aes(label = ..count..), vjust = -0.5, position = position_dodge(5)) +
  theme_minimal() +
  labs(title = &quot;Age Distribution by Rider Type&quot;, x = &quot;Age&quot;, y = &quot;Count&quot;) +
  xlim(0, 100)</code></pre>
<pre><code>## Warning: Removed 539529 rows containing non-finite outside the scale range
## (`stat_bin()`).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range
## (`geom_bar()`).</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<pre class="r"><code># gender split
ggplot(df, aes(x = gender, fill = member_casual)) +
  geom_bar(position = &quot;dodge&quot;) +
  geom_text(stat = &quot;count&quot;, aes(label = ..count..), vjust = -0.5, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = &quot;Gender Breakdown by Rider Type&quot;, x = &quot;Gender&quot;, y = &quot;Count&quot;)</code></pre>
<p><img src="scratch_pad_2019_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>I went through a lot of effort to extract the age and gender data,
and it might not have been worth the value-added to see that member
riders are slightly older and tend to be male-dominated. Not sure this
helps me launch an ad campaign.</p>
<p>And that was how I ended up going on to recent data, 2024…</p>
<img src="resources/images/Logo_Freepik.png" alt="Cyclistic Logo" style="width:200px; display:block; margin:auto;">
<p style="font-size: 12px; color: #555; margin:auto; text-align: center;">
Source: <a href="https://www.freepik.com">Freepik</a>
</p>
</div>

<!-- Footer -->
<footer class="site-footer" role="contentinfo">
  <span class="footer-owner">
    &copy; <span id="copyright-year">2025</span>
    <span class="footer-author">Bryan C. Johns</span>
  </span>
  <span class="footer-links">
    <a
      href="https://johbry17.github.io/portfolio/index.html"
      target="_blank"
      class="portfolio-link"
      aria-label="Portfolio"
    >
      <i
        class="fas fa-laptop-code footer-icon"
        aria-hidden="true"
        title="Portfolio"
      ></i
      >Portfolio
    </a>
    <a
      href="https://www.linkedin.com/in/b-johns/"
      target="_blank"
      class="linkedin-link"
      aria-label="LinkedIn"
    >
      <i
        class="fab fa-linkedin footer-icon"
        aria-hidden="true"
        title="LinkedIn"
      ></i
      >LinkedIn
    </a>
    <a
      href="https://github.com/johbry17/Cyclistic-Analytics"
      target="_blank"
      class="github-link"
      aria-label="GitHub"
    >
      <i class="fab fa-github footer-icon" aria-hidden="true" title="GitHub"></i
      >GitHub
    </a>
  </span>
</footer>
<script>
  // Auto-update year
  const yearElement = document.getElementById("copyright-year");
  if (yearElement) {
    yearElement.textContent = new Date().getFullYear();
  }
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
